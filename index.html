<!DOCTYPE html>
<html lang="hu" data-theme="light">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MunkaÃ³ra â€” ApÃ¡dhelyett AnyÃ¡d ğŸ˜</title>
<style>
/* ============== THEME ============== */
:root {
  --bg-grad-1:#f7f9ff; --bg-grad-2:#eef2ff;
  --card:#ffffff; --text:#111827; --muted:#6b7280; --line:#e9eef7;
  --blue:#0b66ff; --green:#22c55e; --red:#ef4444; --yellow:#facc15;
  --radius:20px; --shadow:0 8px 20px rgba(2,6,23,.06);
}
html[data-theme="dark"] {
  --bg-grad-1:#0b1020; --bg-grad-2:#0f1530;
  --card:#121833; --text:#e9ecff; --muted:#aab2d6; --line:#283255;
  --shadow:0 14px 32px rgba(0,0,0,.45);
}

/* ============== RESET + BASE ============== */
* { box-sizing:border-box; }
html,body { height:100%; margin:0; padding:0; }
body {
  font-family:Inter, system-ui, sans-serif;
  background:linear-gradient(180deg,var(--bg-grad-1),var(--bg-grad-2));
  color:var(--text);
  display:flex; justify-content:center;
}
.wrap {
  width:100%; max-width:480px;
  padding:16px 14px 100px;
}

/* ============== WELCOME SCREEN ============== */
#welcomeScreen {
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  text-align:center;
  padding:20px;
}
.welcome-logo {
  font-size:72px;
  margin-bottom:16px;
  animation: float 3s ease-in-out infinite;
}
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}
.welcome-title {
  font-size:42px;
  font-weight:900;
  margin:0 0 12px;
  background: linear-gradient(135deg, var(--blue), #8b5cf6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.welcome-subtitle {
  font-size:16px;
  color:var(--muted);
  margin:0 0 32px;
  line-height:1.6;
  max-width:320px;
}
.welcome-btn {
  background:var(--blue);
  color:#fff;
  border:none;
  border-radius:16px;
  padding:16px 48px;
  font-size:18px;
  font-weight:800;
  cursor:pointer;
  box-shadow:0 12px 32px rgba(11,102,255,.35);
  transition: transform .2s ease, box-shadow .2s ease;
}
.welcome-btn:hover {
  transform: translateY(-2px);
  box-shadow:0 16px 40px rgba(11,102,255,.45);
}
.welcome-btn:active {
  transform: translateY(0);
}

/* ============== HEADER ============== */
header { display:flex; justify-content:space-between; align-items:flex-start; gap:8px; }
h1 { font-size:26px; font-weight:800; margin:0; }
.subtitle { font-size:13px; color:var(--muted); margin:4px 0 0; line-height:1.3; }
.pill {
  background:rgba(11,102,255,0.1);
  color:var(--blue);
  padding:2px 8px;
  border-radius:999px;
  font-weight:600;
  font-size:11px;
}

/* ============== THEME TOGGLE ============== */
.switch { display:flex; align-items:center; gap:6px; }
.toggle {
  appearance:none;
  width:40px; height:22px;
  background:#cfd8ff44;
  border-radius:999px;
  position:relative;
  cursor:pointer;
}
.toggle::after {
  content:""; position:absolute; top:2px; left:2px;
  width:18px; height:18px;
  border-radius:50%;
  background:#fff;
  box-shadow:0 1px 3px rgba(0,0,0,.2);
  transition:left .2s ease;
}
.toggle:checked::after { left:20px; }

/* ============== TABS ============== */
.tabs {
  display:flex; justify-content:space-around;
  gap:6px; margin:10px 0 12px;
}
.tab {
  flex:1; border:none; border-radius:12px;
  background:#eaf0ff66;
  color:var(--text);
  font-weight:700; font-size:13px;
  padding:10px 0;
}
.tab.active {
  background:var(--blue); color:#fff;
  box-shadow:0 8px 20px rgba(11,102,255,.25);
}

/* ============== CARDS, INPUTS ============== */
.card {
  background:var(--card);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px 14px;
  margin-bottom:16px;
}
h2 { text-align:center; color:var(--blue); margin:0 0 14px; font-size:17px; }

label { display:block; font-size:13px; color:var(--muted); margin-bottom:4px; }
input {
  width:100%; padding:11px 12px;
  border:1px solid var(--line);
  border-radius:12px;
  font-size:15px;
  background:transparent;
  color:var(--text);
}
input:focus {
  border-color:var(--blue);
  outline:none;
  box-shadow:0 0 0 2px rgba(11,102,255,.15);
}

/* ============== BUTTONS ============== */
.row { display:flex; gap:8px; margin-top:10px; }
.btn {
  flex:1; border:none; border-radius:12px;
  padding:12px 0; font-size:14px; font-weight:800;
  color:#fff; cursor:pointer;
}
.btn:hover { opacity:.9; }
.blue{background:var(--blue);}
.green{background:var(--green);}
.red{background:var(--red);}
.gray{background:#e5e7eb; color:#111;}
.yellow{background:var(--yellow); color:#111;}

/* ============== LIST ============== */
.list { list-style:none; padding:0; margin:6px 0 0; }
.item { display:flex; justify-content:space-between; align-items:center; padding:10px 0; border-bottom:1px solid var(--line); }
.badge { font-size:11px; border-radius:999px; padding:3px 6px; font-weight:700; }
.b-green { background:#dffbe7; color:#116a34; }
.b-red { background:#ffe4e4; color:#992323; }

/* ============== COACH ============== */
.bubble {
  position:fixed;
  bottom:80px; right:12px;
  max-width:260px;
  background:var(--blue);
  color:#fff;
  padding:12px 14px;
  border-radius:16px;
  box-shadow:0 8px 24px rgba(0,0,0,.3);
  font-size:13px;
}

/* ============== STATS CANVAS ============== */
canvas { width:100%; height:auto; border-radius:10px; }

/* ============== FOOTER ============== */
footer {
  text-align:center;
  font-size:12px;
  color:var(--muted);
  margin-top:8px;
}

.hidden { display:none !important; }
.hint { font-size:12px; color:var(--muted); margin:8px 0 0; }
.center { text-align:center; }
.grid > div { margin-bottom:10px; }
.sum { display:flex; flex-direction:column; gap:8px; }
.sum > div { display:flex; justify-content:space-between; padding:8px 0; border-bottom:1px solid var(--line); }
.stat-legend { display:flex; align-items:center; margin-bottom:12px; }
.dot { display:inline-block; width:12px; height:12px; border-radius:50%; margin-right:6px; }
.dot.green { background:var(--green); }
.dot.red { background:var(--red); }
</style>
</head>
<body>
  <!-- WELCOME SCREEN -->
  <div id="welcomeScreen">
    <div class="welcome-logo">â°</div>
    <h1 class="welcome-title">MunkaÃ³ra</h1>
    <p class="welcome-subtitle">Tudd meg, hÃ¡ny munkaÃ³rÃ¡dba kerÃ¼lnek a dolgok, Ã©s hozz okosabb dÃ¶ntÃ©seket!</p>
    <button class="welcome-btn" onclick="enterApp()">KezdjÃ¼k! ğŸš€</button>
  </div>

  <!-- MAIN APP -->
  <div class="wrap hidden" id="mainApp">
    <header>
      <div>
        <h1>MunkaÃ³ra</h1>
        <p class="subtitle">Tudd, hÃ¡ny Ã³rÃ¡t dolgozol a vÃ¡gyaidÃ©rt. <span class="pill">+ ApÃ¡dhelyett AnyÃ¡d ğŸ˜</span></p>
      </div>
      <div class="switch">
        <span class="pill" id="modeLabel">VilÃ¡gos</span>
        <input id="themeToggle" class="toggle" type="checkbox" />
      </div>
    </header>

    <nav class="tabs">
      <button class="tab active" data-view="profile">Profil</button>
      <button class="tab" data-view="calc">KalkulÃ¡tor</button>
      <button class="tab" data-view="results">EredmÃ©nyek</button>
      <button class="tab" data-view="stats">Statisztika</button>
    </nav>

    <!-- PROFILE -->
    <section id="view-profile" class="card">
      <h2>Profilod</h2>
      <div class="grid">
        <div>
          <label for="name">BecenÃ©v</label>
          <input id="name" type="text" placeholder="Add meg a beceneved" />
        </div>
        <div>
          <label for="age">Kor</label>
          <input id="age" type="number" min="1" placeholder="Add meg a korod" />
        </div>
        <div>
          <label for="salary">NettÃ³ havi fizetÃ©s (Ft)</label>
          <input id="salary" type="number" min="1" placeholder="pl. 450000" />
        </div>
        <div>
          <label for="hours">Heti munkaÃ³rÃ¡k</label>
          <input id="hours" type="number" min="1" placeholder="pl. 40" />
        </div>
      </div>
      <div class="row">
        <button class="btn blue" id="saveProfile">MentÃ©s</button>
        <button class="btn gray" id="deleteProfile">Profil tÃ¶rlÃ©se</button>
      </div>
      <p class="hint">MentÃ©s utÃ¡n a KalkulÃ¡tor fÃ¼lÃ¶n szÃ¡molhatsz.</p>
    </section>

    <!-- CALCULATOR -->
    <section id="view-calc" class="card hidden">
      <h2>KalkulÃ¡tor</h2>
      <p class="center" id="hello">Szia! TÃ¶ltsd ki a profilod a pontos szÃ¡mÃ­tÃ¡shoz.</p>
      <div class="grid">
        <div>
          <label for="productName">TermÃ©k neve</label>
          <input id="productName" type="text" placeholder="pl. AirPods Pro" />
        </div>
        <div>
          <label for="productPrice">TermÃ©k Ã¡ra (Ft)</label>
          <input id="productPrice" type="number" min="1" placeholder="pl. 79990" />
        </div>
      </div>
      <div class="row">
        <button class="btn yellow" id="calculateBtn">KiszÃ¡molom</button>
      </div>
      <div id="calcResult" class="hidden">
        <p class="center hint" id="hourlyHint"></p>
        <p class="center" style="font-weight:900;margin:10px 0 6px" id="workHoursText"></p>
        <div class="row">
          <button class="btn green" id="saveBtn">MegspÃ³rolom ğŸ’š</button>
          <button class="btn red" id="buyBtn">Megveszem ğŸ’¸</button>
        </div>
      </div>
    </section>

    <!-- RESULTS -->
    <section id="view-results" class="card hidden">
      <h2>EredmÃ©nyek</h2>
      <div class="sum">
        <div><span>ğŸ’š MegspÃ³rolt Ã¶sszeg</span><b id="totalSaved">0 Ft</b></div>
        <div><span>ğŸ’¸ ElkÃ¶ltÃ¶tt Ã¶sszeg</span><b id="totalSpent">0 Ft</b></div>
        <div><span class="muted">ğŸ§® NettÃ³</span><b id="net">0 Ft</b></div>
      </div>
      <h3 style="margin:10px 0 6px">MegspÃ³rolt tÃ©telek</h3>
      <ul class="list" id="savedList"></ul>

      <h3 style="margin:12px 0 6px">Megvett tÃ©telek</h3>
      <ul class="list" id="spentList"></ul>

      <div class="row" style="margin-top:12px">
        <button class="btn blue" data-view="calc">Vissza a kalkulÃ¡torhoz</button>
        <button class="btn gray" id="clearAll">Lista Ã¼rÃ­tÃ©se</button>
      </div>
    </section>

    <!-- STATS -->
    <section id="view-stats" class="card hidden">
      <h2>Statisztika</h2>
      <div class="stat-legend">
        <span class="dot green"></span><span class="hint">MegspÃ³rolt</span>
        <span class="dot red" style="margin-left:12px"></span><span class="hint">Megvett</span>
      </div>
      <canvas id="statsCanvas" width="640" height="360" style="width:100%;height:auto;border-radius:12px;background:#ffffff08"></canvas>
      <p class="hint center">Havi bontÃ¡s az eddigi tÃ©teleidbÅ‘l (Ft).</p>
    </section>

    <footer>Â© 2025 MunkaÃ³ra â€¢ ApÃ¡dhelyett AnyÃ¡d ğŸ˜</footer>
    <div id="coach" class="bubble hidden"></div>
  </div>

<script>
/* ================== WELCOME SCREEN ================== */
function enterApp() {
  document.getElementById("welcomeScreen").classList.add("hidden");
  document.getElementById("mainApp").classList.remove("hidden");
}

/* ================== UTIL + DATA ================== */
const $ = sel => document.querySelector(sel);
const $$ = sel => [...document.querySelectorAll(sel)];
const fmtFt = v => new Intl.NumberFormat("hu-HU",{style:"currency",currency:"HUF",maximumFractionDigits:0}).format(Number(v||0));
const esc = s => (s||"").replace(/[&<>"']/g, m=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;" }[m]));
const Data = {
  get(k){ try{ const v=localStorage.getItem(k); return v?JSON.parse(v):null }catch(e){ return null } },
  set(k,v){ try{ localStorage.setItem(k, JSON.stringify(v)); return true }catch(e){ return false } },
  clear(){ ["profile","saved","spent"].forEach(k=>localStorage.removeItem(k)) }
};

/* ================== THEME ================== */
const themeToggle = $("#themeToggle");
const modeLabel = $("#modeLabel");
function applyTheme(theme){
  document.documentElement.setAttribute("data-theme", theme);
  themeToggle.checked = theme==="dark";
  modeLabel.textContent = theme==="dark" ? "SÃ¶tÃ©t" : "VilÃ¡gos";
  localStorage.setItem("theme", theme);
}
applyTheme(localStorage.getItem("theme") || "light");
themeToggle.addEventListener("change", ()=> applyTheme(themeToggle.checked?"dark":"light"));

/* ================== TABS / VIEWS ================== */
const tabs = $$(".tab");
const views = {
  profile: $("#view-profile"),
  calc: $("#view-calc"),
  results: $("#view-results"),
  stats: $("#view-stats"),
};
function setView(name){
  tabs.forEach(t=>t.classList.toggle("active", t.dataset.view===name));
  Object.entries(views).forEach(([k,el])=> el.classList.toggle("hidden", k!==name));
  if(name==="calc") syncHello();
  if(name==="results") renderResults();
  if(name==="stats") drawStats();
  window.scrollTo({top:0, behavior:"smooth"});
}
tabs.forEach(t=> t.addEventListener("click", ()=> setView(t.dataset.view)));
$$('[data-view="calc"]').forEach(btn=> btn.addEventListener("click", ()=> setView("calc")));

/* ================== COACH MESSAGES (100+) ================== */
const COACH = [
"Ejnye, ezÃ©rt most sokat fogsz dolgozni. ğŸ˜¬","A pÃ©nztÃ¡rcÃ¡d halk sÃ­rÃ¡st hallatott. ğŸ’¸","A jÃ¶vÅ‘beli Ã©ned most csÃ³vÃ¡lja a fejÃ©t.",
"Ha boldoggÃ¡ tesz, okÃ© â€“ de sok Ã³rÃ¡dba kerÃ¼l.","Ez mÃ¡r a 'drÃ¡ga, de kell' kategÃ³ria? ğŸ¤¨","A bankszÃ¡mlÃ¡d szabadsÃ¡gra ment.",
"10 Ã³rÃ¡n tÃºl? AnyÃ¡d felhÃ­vna. ğŸ«¨","LegkÃ¶zelebb Ã­rd be: 'gondolkozzak mÃ©g'.","A racionalitÃ¡s most ebÃ©del. ğŸ½ï¸","LegalÃ¡bb szÃ©p lesz. RemÃ©ljÃ¼k.",
"Ez egy hosszÃº mÅ±szak Ã¡ra. â³","Instant dopamin, tartÃ³s mÃ­nusz. âš¡ï¸","A lelkiismereted most offline.","KÃ¡vÃ© helyett most dolgozol Ã©rte mÃ©g pÃ¡rat.",
"Nem muszÃ¡j, de megtetted. ğŸ˜…","A matek nem tapsol most. ğŸ§®","Ezen most a pÃ©nzÃ¼gyi coach felszisszent.","OkÃ©, de hasznÃ¡ld is naponta!",
"A jÃ³zan Ã©sz most AFK. ğŸ“´","Ha meghoznÃ¡d Ãºjra ezt a dÃ¶ntÃ©st? Biztos?","Egy tÃ©tel, kÃ©t sÃ³haj. ğŸ˜®â€ğŸ’¨","Ez a 'szÃ­v dÃ¶ntÃ¶tt' vÃ¡sÃ¡rlÃ¡s.",
"Minimum egy hÃ©tvÃ©ge ment rÃ¡.","Nem rossz, csakâ€¦ drÃ¡ga.","Ha akciÃ³s volt, kicsit kevÃ©sbÃ© fÃ¡j.","A 'majd visszateszem' gomb letiltva? ğŸ˜",
"Ezt a dÃ¶ntÃ©st screenshotolom a tanmesÃ©hez. ğŸ“¸","Kis lÃ©pÃ©s a tÃ¡rgy felÃ©, nagy lÃ©pÃ©s a mÃ­nuszba.","Ã‰rzed azt a kis bÃ¶kÃ©st? Az a bankkÃ¡rtya. ğŸ’³",
"Naâ€¦ legalÃ¡bb sztori lesz. ğŸ“–","A spÃ³rolÃ¡s most szÃ¼netel. ğŸ§˜","Ha ezt megspÃ³roltad volnaâ€¦","Ez mÃ¡r 'luxus-szagÃº' dÃ¶ntÃ©s. ğŸ’",
"A jÃ¶vÅ‘ heti ebÃ©ded integet. ğŸ","10+ Ã³ra? Ez mÃ¡r szerelem.","Tudod, hogy ezÃ©rt tÃºlÃ³rÃ¡zol majd?","A kÃ¶ltsÃ©gvetÃ©sed most kÃ©r egy Ã¶lelÃ©st.",
"Ez a vÃ¡sÃ¡rlÃ¡s beszÃ©lgetÃ©st Ã©rdemel.","A mÃ©rleg: Ã¶rÃ¶m + bÅ±ntudat = egyenleg?","Az Ã©sz helyett a szem dÃ¶ntÃ¶tt. ğŸ‘€","Valaki most nagyon boldog (a kereskedÅ‘).",
"RemÃ©ljÃ¼k legalÃ¡bb tartÃ³s.","Ha ez motivÃ¡l a munkÃ¡ra â€“ rendben. ğŸ’ª","PÃ©nzÃ¼gyi edzÃ©s: ma farizom + pÃ©nztÃ¡rca.","Ezt a 'szÃ¼ksÃ©ges' szÃ³t feszegetjÃ¼k.",
"A spÃ³rolÃ¡sod most levegÅ‘t vesz.","Kedves, de kÃ¶ltsÃ©ges.","A 'csak megnÃ©zem' utÃ¡n ez lett. ğŸ›’","Ã‰n szÃ³ltam volnaâ€¦ ha kÃ©rdezel. ğŸ˜‰",
"Egy tÃ¡rgy, sok Ã³ra. JÃ³ csere?","A fej szÃ¡mol, a szÃ­v vÃ¡sÃ¡rol.","Ha ezt bÃ©rben mÃ©rnÃ©nk, sok lenne.","Majd amikor jÃ¶n a rezsi, emlÃ©kezz. ğŸ§¾",
"Ez mÃ¡r 'felnÅ‘tt dÃ¶ntÃ©s' â€“ Ã¡ra van.","A bankod is lÃ¡tta ezt, ugye? ğŸ‘€","Ha ez Ã¶rÃ¶mÃ¶t hoz, okÃ© â€“ de sokba kerÃ¼lt.","Instant jÃ³ Ã©rzÃ©s, kÃ©sleltetett fÃ¡jÃ¡s.",
"Nem baj, tanulÃ³pÃ©nz. DrÃ¡ga tanulÃ³pÃ©nz.","Anyai sÃ³haj: *hosszan*. ğŸ˜®â€ğŸ’¨","Ha ezt eladnÃ¡d kÃ©sÅ‘bbâ€¦ kÃ©rdÃ©ses.","Ez mÃ¡r 'jÃ³, de muszÃ¡j volt?' kategÃ³ria.",
"KÃ¶vetkezÅ‘re Ã­rj listÃ¡t. ğŸ“","A hatÃ¡ridÅ‘k is integetnek most. â°","A spÃ³rolÃ¡sod megbicsaklott.","A pÃ©nzed kicsit elszaladt kÃ¡vÃ©zni. â˜•",
"Egy 'majd legkÃ¶zelebb' gomb hiÃ¡nyzott.","Ezt a dÃ¶ntÃ©st a jÃ¶vÅ‘beli te Ã©rtÃ©kelni fogja? ğŸ¤”","Tarts egy 24 Ã³rÃ¡s szabÃ¡lyt legkÃ¶zelebb.",
"Most mÃ¡r legalÃ¡bb motivÃ¡lt vagy dolgozni. ğŸ˜…","A kÃ¶ltsÃ©gvetÃ©sed kÃ©r egy meetinget. ğŸ“Š","Ez kÃ©rem prÃ©selt munkaÃ³rÃ¡kbÃ³l kÃ©szÃ¼lt. ğŸ”§",
"A hitelkÃ¡rtyÃ¡d halkan remeg.","Ez az Ã©lmÃ©ny remÃ©ljÃ¼k nem mÃºlÃ³.","Ha ezt egyszerÅ±en 'kellett' â€“ jÃ³ van.","Az Ã©sz: 'nem', a vÃ¡gy: 'igen'.",
"A pÃ©nzÃ¼gyi hatÃ¡r most kicsit csÃºszott.","A 'spÃ³rolom' gomb is ott volt Ã¡m.","Kicsit tÃ¶bb lett, mint 'aprÃ³'.","LegalÃ¡bb kipipÃ¡lhatsz valamit a listÃ¡n.",
"Gondold Ã¡t: 10+ Ã³ra = ez a tÃ¡rgy.","A kompromisszumok drÃ¡gÃ¡k.","A minimalizmus most elfordult. ğŸ§˜â€â™‚ï¸","Na jÃ³l van, de most spÃ³rolÃ³s hÃ©t jÃ¶n!",
"A pÃ©nzÃ¼gyi Ã©n-ed most sÃ­r.","Ha ez hobbi: okÃ©. Ha hÃ³bort: kÃ©tszer gondold Ã¡t.","A 'miÃ©rt' erÅ‘sebb volt, mint a 'mennyi'.",
"Egy kis bÅ±ntudat, egy nagy doboz. ğŸ“¦","KÃ¶zelebb kerÃ¼ltÃ©l hozzÃ¡ â€“ a bankszÃ¡mla tÃ¡volabb.","Az Ã¡r-Ã©rtÃ©k arÃ¡ny most vitatott.",
"Ez a 'megÃ©rdemlem' pillanat?","JutalomvÃ¡sÃ¡rlÃ¡s? Akkor hajrÃ¡ â€“ ritkÃ¡n.","A tÃ¼relem gyakran olcsÃ³bb. â³","A 'most azonnal kell' a legdrÃ¡gÃ¡bb.",
"Ha a munkÃ¡d boldoggÃ¡ tesz â€“ megdolgoztÃ¡l Ã©rte.","A jÃ¶vÅ‘beli szÃ¡mlÃ¡k nem felejtenek.","A keret csipogott. ğŸ“‰","A dÃ¶ntÃ©s megvan â€“ most hasznÃ¡ld is, sokat!",
"Minimum 10 Ã³ra â€“ maximum Ã¶rÃ¶m?","Ha ez inspirÃ¡l: nyertÃ©l. Ha nem: tanultÃ¡l.","OkÃ©, de a kÃ¶vetkezÅ‘ legyen 'MegspÃ³rolom'.",
"A bankod eddig bÃ­rta nevetÃ©s nÃ©lkÃ¼l. ğŸ˜¬","Minden rendben â€“ csak most kicsit drÃ¡ga lett.","A spÃ³rolÃ¡sod most visszaszÃ¡mol.",
"Ezt mÃ©g AnyÃ¡d is megkÃ©rdeznÃ©: kellett?","ZÃ¡rjuk le: hasznÃ¡ld egÃ©szsÃ©ggel, okosan. âœ…"
];

/* ================== PROFILE ================== */
const nameEl=$("#name"), ageEl=$("#age"), salaryEl=$("#salary"), hoursEl=$("#hours");
const saveBtn=$("#saveProfile"), delBtn=$("#deleteProfile");
function loadProfile(){
  const p = Data.get("profile"); if(!p) return;
  nameEl.value=p.name||""; ageEl.value=p.age||""; salaryEl.value=p.salary||""; hoursEl.value=p.hours||"";
}
function saveProfile(){
  const p = { name: nameEl.value.trim(), age: Number(ageEl.value), salary: Number(salaryEl.value), hours: Number(hoursEl.value) };
  if(!p.name || !p.age || !p.salary || !p.hours){ alert("TÃ¶lts ki minden mezÅ‘t!"); return; }
  Data.set("profile", p);
  if(!Data.get("saved")) Data.set("saved", []);
  if(!Data.get("spent")) Data.set("spent", []);
  setView("calc");
}
function deleteProfile(){
  if(!confirm("Biztos tÃ¶rlÃ¶d a profilodat Ã©s a listÃ¡kat?")) return;
  Data.clear(); nameEl.value=ageEl.value=salaryEl.value=hoursEl.value="";
  setView("profile");
}
saveBtn.addEventListener("click", saveProfile);
delBtn.addEventListener("click", deleteProfile);

/* ================== CALCULATOR ================== */
const hello=$("#hello"), hourlyHint=$("#hourlyHint");
const productName=$("#productName"), productPrice=$("#productPrice");
const calcBtn=$("#calculateBtn"), calcResult=$("#calcResult"), hoursText=$("#workHoursText");
const saveChoice=$("#saveBtn"), buyChoice=$("#buyBtn");

function syncHello(){
  const p = Data.get("profile");
  if(!p){ hello.textContent="Szia! TÃ¶ltsd ki a profilod a pontos szÃ¡mÃ­tÃ¡shoz."; return; }
  hello.innerHTML = `Szia <b>${esc(p.name||"")}</b>! NÃ©zzÃ¼k meg, hÃ¡ny Ã³rÃ¡dba kerÃ¼lne.`;
}
function calculate(){
  const p = Data.get("profile");
  if(!p){ setView("profile"); return; }
  const name = productName.value.trim();
  const price = Number(productPrice.value);
  if(!name || !price || price<=0){ alert("Add meg a termÃ©k nevÃ©t Ã©s Ã¡rÃ¡t!"); return; }
  const hourly = p.salary / (p.hours*4);
  if(!hourly || hourly<=0){ alert("Ã‰rvÃ©nytelen profil adatok."); return; }
  const h = price / hourly;
  hourlyHint.textContent = `Jelenlegi Ã³rabÃ©red ~ ${fmtFt(hourly)}/Ã³ra`;
  hoursText.textContent = `Kb. ${h.toFixed(1)} munkaÃ³rÃ¡dba kerÃ¼lne (${fmtFt(price)}).`;
  calcResult.dataset.name=name; calcResult.dataset.price=String(price); calcResult.dataset.hours=String(h);
  calcResult.classList.remove("hidden");
}
calcBtn.addEventListener("click", calculate);

function commit(type){
  const name = calcResult.dataset.name;
  const price = Number(calcResult.dataset.price);
  const hours = Number(calcResult.dataset.hours);
  if(!name || !price){ alert("ElÅ‘bb szÃ¡molj!"); return; }
  const list = Data.get(type)||[];
  list.unshift({name, price, hours, at: Date.now(), type});
  Data.set(type, list);
  if(type==="spent" && hours>10){ showCoach(); } else { setView("results"); }
}
saveChoice.addEventListener("click", ()=>commit("saved"));
buyChoice.addEventListener("click", ()=>commit("spent"));

function showCoach(){
  const b=$("#coach");
  b.textContent="ApÃ¡dhelyett AnyÃ¡d: " + COACH[Math.floor(Math.random()*COACH.length)];
  b.classList.remove("hidden");
  setTimeout(()=>{ b.classList.add("hidden"); setView("results"); }, 2400);
}

/* ================== RESULTS ================== */
const savedList=$("#savedList"), spentList=$("#spentList");
const totalSaved=$("#totalSaved"), totalSpent=$("#totalSpent"), net=$("#net");
const clearAll=$("#clearAll");

function renderResults(){
  const saved=Data.get("saved")||[], spent=Data.get("spent")||[];
  savedList.innerHTML=""; spentList.innerHTML="";
  let s=0,e=0;
  saved.forEach((it,idx)=>{
    s+=Number(it.price);
    const li=document.createElement("li"); li.className="item";
    li.innerHTML=`<span><span class="badge b-green">spÃ³rolt</span> <span class="name">${esc(it.name)}</span></span>
                  <span class="price">${fmtFt(it.price)}</span>`;
    savedList.appendChild(li);
  });
  spent.forEach((it,idx)=>{
    e+=Number(it.price);
    const li=document.createElement("li"); li.className="item";
    li.innerHTML=`<span><span class="badge b-red">vett</span> <span class="name">${esc(it.name)}</span></span>
                  <span class="price">${fmtFt(it.price)}</span>`;
    spentList.appendChild(li);
  });
  totalSaved.textContent=fmtFt(s);
  totalSpent.textContent=fmtFt(e);
  net.textContent
