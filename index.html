<!DOCTYPE html>
<html lang="hu" data-theme="light">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Munka√≥ra ‚Äî Ap√°dhelyett Any√°d üòè</title>
<style>
/* ============== THEME ============== */
:root {
  --bg-grad-1:#f7f9ff; --bg-grad-2:#eef2ff;
  --card:#ffffff; --text:#111827; --muted:#6b7280; --line:#e9eef7;
  --blue:#0b66ff; --green:#22c55e; --red:#ef4444; --yellow:#facc15;
  --radius:20px; --shadow:0 8px 20px rgba(2,6,23,.06);
}
html[data-theme="dark"] {
  --bg-grad-1:#0b1020; --bg-grad-2:#0f1530;
  --card:#121833; --text:#e9ecff; --muted:#aab2d6; --line:#283255;
  --shadow:0 14px 32px rgba(0,0,0,.45);
}

/* ============== RESET + BASE ============== */
* { box-sizing:border-box; }
html,body { height:100%; margin:0; padding:0; }
body {
  font-family:Inter, system-ui, sans-serif;
  background:linear-gradient(180deg,var(--bg-grad-1),var(--bg-grad-2));
  color:var(--text);
  display:flex; justify-content:center;
}
.wrap {
  width:100%; max-width:480px;
  padding:16px 14px 100px;
}

/* ============== WELCOME SCREEN ============== */
#welcomeScreen {
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  text-align:center;
  padding:20px;
}
.welcome-logo {
  font-size:72px;
  margin-bottom:16px;
  animation: float 3s ease-in-out infinite;
}
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}
.welcome-title {
  font-size:42px;
  font-weight:900;
  margin:0 0 12px;
  background: linear-gradient(135deg, var(--blue), #8b5cf6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.welcome-subtitle {
  font-size:16px;
  color:var(--muted);
  margin:0 0 32px;
  line-height:1.6;
  max-width:320px;
}
.welcome-btn {
  background:var(--blue);
  color:#fff;
  border:none;
  border-radius:16px;
  padding:16px 48px;
  font-size:18px;
  font-weight:800;
  cursor:pointer;
  box-shadow:0 12px 32px rgba(11,102,255,.35);
  transition: transform .2s ease, box-shadow .2s ease;
}
.welcome-btn:hover {
  transform: translateY(-2px);
  box-shadow:0 16px 40px rgba(11,102,255,.45);
}
.welcome-btn:active {
  transform: translateY(0);
}

/* ============== HEADER ============== */
header { display:flex; justify-content:space-between; align-items:flex-start; gap:8px; }
h1 { font-size:26px; font-weight:800; margin:0; }
.subtitle { font-size:13px; color:var(--muted); margin:4px 0 0; line-height:1.3; }
.pill {
  background:rgba(11,102,255,0.1);
  color:var(--blue);
  padding:2px 8px;
  border-radius:999px;
  font-weight:600;
  font-size:11px;
}

/* ============== THEME TOGGLE ============== */
.switch { display:flex; align-items:center; gap:6px; }
.toggle {
  appearance:none;
  width:40px; height:22px;
  background:#cfd8ff44;
  border-radius:999px;
  position:relative;
  cursor:pointer;
}
.toggle::after {
  content:""; position:absolute; top:2px; left:2px;
  width:18px; height:18px;
  border-radius:50%;
  background:#fff;
  box-shadow:0 1px 3px rgba(0,0,0,.2);
  transition:left .2s ease;
}
.toggle:checked::after { left:20px; }

/* ============== TABS ============== */
.tabs {
  display:flex; justify-content:space-around;
  gap:6px; margin:10px 0 12px;
}
.tab {
  flex:1; border:none; border-radius:12px;
  background:#eaf0ff66;
  color:var(--text);
  font-weight:700; font-size:13px;
  padding:10px 0;
  cursor:pointer;
}
.tab.active {
  background:var(--blue); color:#fff;
  box-shadow:0 8px 20px rgba(11,102,255,.25);
}

/* ============== CARDS, INPUTS ============== */
.card {
  background:var(--card);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px 14px;
  margin-bottom:16px;
}
h2 { text-align:center; color:var(--blue); margin:0 0 14px; font-size:17px; }

label { display:block; font-size:13px; color:var(--muted); margin-bottom:4px; }
input {
  width:100%; padding:11px 12px;
  border:1px solid var(--line);
  border-radius:12px;
  font-size:15px;
  background:transparent;
  color:var(--text);
}
input:focus {
  border-color:var(--blue);
  outline:none;
  box-shadow:0 0 0 2px rgba(11,102,255,.15);
}

/* ============== BUTTONS ============== */
.row { display:flex; gap:8px; margin-top:10px; }
.btn {
  flex:1; border:none; border-radius:12px;
  padding:12px 0; font-size:14px; font-weight:800;
  color:#fff; cursor:pointer;
}
.btn:hover { opacity:.9; }
.blue{background:var(--blue);}
.green{background:var(--green);}
.red{background:var(--red);}
.gray{background:#e5e7eb; color:#111;}
.yellow{background:var(--yellow); color:#111;}

/* ============== LIST ============== */
.list { list-style:none; padding:0; margin:6px 0 0; }
.item { display:flex; justify-content:space-between; align-items:center; padding:10px 0; border-bottom:1px solid var(--line); }
.badge { font-size:11px; border-radius:999px; padding:3px 6px; font-weight:700; }
.b-green { background:#dffbe7; color:#116a34; }
.b-red { background:#ffe4e4; color:#992323; }

/* ============== COACH ============== */
.bubble {
  position:fixed;
  bottom:80px; right:12px;
  max-width:260px;
  background:var(--blue);
  color:#fff;
  padding:12px 14px;
  border-radius:16px;
  box-shadow:0 8px 24px rgba(0,0,0,.3);
  font-size:13px;
}

/* ============== STATS CANVAS ============== */
canvas { width:100%; height:auto; border-radius:10px; }

/* ============== FOOTER ============== */
footer {
  text-align:center;
  font-size:12px;
  color:var(--muted);
  margin-top:8px;
}

.hidden { display:none !important; }
.hint { font-size:12px; color:var(--muted); margin:8px 0 0; }
.center { text-align:center; }
.grid > div { margin-bottom:10px; }
.sum { display:flex; flex-direction:column; gap:8px; }
.sum > div { display:flex; justify-content:space-between; padding:8px 0; border-bottom:1px solid var(--line); }
.stat-legend { display:flex; align-items:center; margin-bottom:12px; }
.dot { display:inline-block; width:12px; height:12px; border-radius:50%; margin-right:6px; }
.dot.green { background:var(--green); }
.dot.red { background:var(--red); }
</style>
</head>
<body>
  <!-- WELCOME SCREEN -->
  <div id="welcomeScreen">
    <div class="welcome-logo">‚è∞</div>
    <h1 class="welcome-title">Munka√≥ra</h1>
    <p class="welcome-subtitle">Tudd meg, h√°ny munka√≥r√°dba ker√ºlnek a dolgok, √©s hozz okosabb d√∂nt√©seket!</p>
    <button class="welcome-btn" id="enterAppBtn">Kezdj√ºk! üöÄ</button>
  </div>

  <!-- MAIN APP -->
  <div class="wrap hidden" id="mainApp">
    <header>
      <div>
        <h1>Munka√≥ra</h1>
        <p class="subtitle">Tudd, h√°ny √≥r√°t dolgozol a v√°gyaid√©rt. <span class="pill">+ Ap√°dhelyett Any√°d üòè</span></p>
      </div>
      <div class="switch">
        <span class="pill" id="modeLabel">Vil√°gos</span>
        <input id="themeToggle" class="toggle" type="checkbox" />
      </div>
    </header>

    <nav class="tabs">
      <button class="tab active" data-view="profile">Profil</button>
      <button class="tab" data-view="calc">Kalkul√°tor</button>
      <button class="tab" data-view="results">Eredm√©nyek</button>
      <button class="tab" data-view="stats">Statisztika</button>
    </nav>

    <!-- PROFILE -->
    <section id="view-profile" class="card">
      <h2>Profilod</h2>
      <div class="grid">
        <div>
          <label for="name">Becen√©v</label>
          <input id="name" type="text" placeholder="Add meg a beceneved" />
        </div>
        <div>
          <label for="age">Kor</label>
          <input id="age" type="number" min="1" placeholder="Add meg a korod" />
        </div>
        <div>
          <label for="salary">Nett√≥ havi fizet√©s (Ft)</label>
          <input id="salary" type="number" min="1" placeholder="pl. 450000" />
        </div>
        <div>
          <label for="hours">Heti munka√≥r√°k</label>
          <input id="hours" type="number" min="1" placeholder="pl. 40" />
        </div>
      </div>
      <div class="row">
        <button class="btn blue" id="saveProfile">Ment√©s</button>
        <button class="btn gray" id="deleteProfile">Profil t√∂rl√©se</button>
      </div>
      <p class="hint">Ment√©s ut√°n a Kalkul√°tor f√ºl√∂n sz√°molhatsz.</p>
    </section>

    <!-- CALCULATOR -->
    <section id="view-calc" class="card hidden">
      <h2>Kalkul√°tor</h2>
      <p class="center" id="hello">Szia! T√∂ltsd ki a profilod a pontos sz√°m√≠t√°shoz.</p>
      <div class="grid">
        <div>
          <label for="productName">Term√©k neve</label>
          <input id="productName" type="text" placeholder="pl. AirPods Pro" />
        </div>
        <div>
          <label for="productPrice">Term√©k √°ra (Ft)</label>
          <input id="productPrice" type="number" min="1" placeholder="pl. 79990" />
        </div>
      </div>
      <div class="row">
        <button class="btn yellow" id="calculateBtn">Kisz√°molom</button>
      </div>
      <div id="calcResult" class="hidden">
        <p class="center hint" id="hourlyHint"></p>
        <p class="center" style="font-weight:900;margin:10px 0 6px" id="workHoursText"></p>
        <div class="row">
          <button class="btn green" id="saveBtn">Megsp√≥rolom üíö</button>
          <button class="btn red" id="buyBtn">Megveszem üí∏</button>
        </div>
      </div>
    </section>

    <!-- RESULTS -->
    <section id="view-results" class="card hidden">
      <h2>Eredm√©nyek</h2>
      <div class="sum">
        <div><span>üíö Megsp√≥rolt √∂sszeg</span><b id="totalSaved">0 Ft</b></div>
        <div><span>üí∏ Elk√∂lt√∂tt √∂sszeg</span><b id="totalSpent">0 Ft</b></div>
        <div><span class="muted">üßÆ Nett√≥</span><b id="net">0 Ft</b></div>
      </div>
      <h3 style="margin:10px 0 6px">Megsp√≥rolt t√©telek</h3>
      <ul class="list" id="savedList"></ul>

      <h3 style="margin:12px 0 6px">Megvett t√©telek</h3>
      <ul class="list" id="spentList"></ul>

      <div class="row" style="margin-top:12px">
        <button class="btn blue" data-view="calc">Vissza a kalkul√°torhoz</button>
        <button class="btn gray" id="clearAll">Lista √ºr√≠t√©se</button>
      </div>
    </section>

    <!-- STATS -->
    <section id="view-stats" class="card hidden">
      <h2>Statisztika</h2>
      <div class="stat-legend">
        <span class="dot green"></span><span class="hint">Megsp√≥rolt</span>
        <span class="dot red" style="margin-left:12px"></span><span class="hint">Megvett</span>
      </div>
      <canvas id="statsCanvas" width="640" height="360" style="width:100%;height:auto;border-radius:12px;background:#ffffff08"></canvas>
      <p class="hint center">Havi bont√°s az eddigi t√©teleidb≈ël (Ft).</p>
    </section>

    <footer>¬© 2025 Munka√≥ra ‚Ä¢ Ap√°dhelyett Any√°d üòè</footer>
    <div id="coach" class="bubble hidden"></div>
  </div>

<script>
// ================== DATA LAYER (backend-ready) ==================
const DataAPI = {
  // LocalStorage implementation (can be replaced with fetch() calls to backend)
  storage: {
    get: function(key) {
      try {
        const val = localStorage.getItem(key);
        return val ? JSON.parse(val) : null;
      } catch(e) {
        console.error('Storage get error:', e);
        return null;
      }
    },
    set: function(key, value) {
      try {
        localStorage.setItem(key, JSON.stringify(value));
        return true;
      } catch(e) {
        console.error('Storage set error:', e);
        return false;
      }
    },
    remove: function(key) {
      try {
        localStorage.removeItem(key);
        return true;
      } catch(e) {
        console.error('Storage remove error:', e);
        return false;
      }
    }
  },
  
  // Profile methods
  getProfile: function() {
    return this.storage.get('profile');
  },
  saveProfile: function(data) {
    return this.storage.set('profile', data);
  },
  deleteProfile: function() {
    this.storage.remove('profile');
    this.storage.remove('saved');
    this.storage.remove('spent');
    return true;
  },
  
  // Items methods
  getSaved: function() {
    return this.storage.get('saved') || [];
  },
  getSpent: function() {
    return this.storage.get('spent') || [];
  },
  addItem: function(type, item) {
    const list = this.storage.get(type) || [];
    list.unshift({...item, at: Date.now(), type});
    return this.storage.set(type, list);
  },
  clearItems: function() {
    this.storage.set('saved', []);
    this.storage.set('spent', []);
    return true;
  },
  
  // Theme methods
  getTheme: function() {
    return this.storage.get('theme') || 'light';
  },
  setTheme: function(theme) {
    return this.storage.set('theme', theme);
  }
};

// ================== UTILITIES ==================
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => [...document.querySelectorAll(sel)];
const fmtFt = (v) => new Intl.NumberFormat("hu-HU", {
  style: "currency",
  currency: "HUF",
  maximumFractionDigits: 0
}).format(Number(v || 0));
const esc = (s) => (s || "").replace(/[&<>"']/g, m => ({
  "&": "&amp;",
  "<": "&lt;",
  ">": "&gt;",
  "\"": "&quot;",
  "'": "&#39;"
}[m]));

// ================== APP STATE ==================
const App = {
  currentView: 'profile',
  
  init: function() {
    this.bindWelcomeScreen();
    this.bindTheme();
    this.bindTabs();
    this.bindProfile();
    this.bindCalculator();
    this.bindResults();
  },
  
  // Welcome Screen
  bindWelcomeScreen: function() {
    const btn = $('#enterAppBtn');
    if (btn) {
      btn.addEventListener('click', () => {
        $('#welcomeScreen').classList.add('hidden');
        $('#mainApp').classList.remove('hidden');
        const profile = DataAPI.getProfile();
        this.setView(profile ? 'calc' : 'profile');
      });
    }
  },
  
  // Theme
  bindTheme: function() {
    const toggle = $('#themeToggle');
    const label = $('#modeLabel');
    
    const applyTheme = (theme) => {
      document.documentElement.setAttribute('data-theme', theme);
      if (toggle) toggle.checked = theme === 'dark';
      if (label) label.textContent = theme === 'dark' ? 'S√∂t√©t' : 'Vil√°gos';
      DataAPI.setTheme(theme);
    };
    
    applyTheme(DataAPI.getTheme());
    
    if (toggle) {
      toggle.addEventListener('change', () => {
        applyTheme(toggle.checked ? 'dark' : 'light');
      });
    }
  },
  
  // Tabs/Views
  bindTabs: function() {
    const tabs = $$('.tab');
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        this.setView(tab.dataset.view);
      });
    });
    
    $$('[data-view="calc"]').forEach(btn => {
      btn.addEventListener('click', () => this.setView('calc'));
    });
  },
  
  setView: function(name) {
    this.currentView = name;
    const tabs = $$('.tab');
    const views = {
      profile: $('#view-profile'),
      calc: $('#view-calc'),
      results: $('#view-results'),
      stats: $('#view-stats')
    };
    
    tabs.forEach(t => t.classList.toggle('active', t.dataset.view === name));
    Object.entries(views).forEach(([k, el]) => {
      if (el) el.classList.toggle('hidden', k !== name);
    });
    
    if (name === 'calc') this.syncCalcHello();
    if (name === 'results') this.renderResults();
    if (name === 'stats') this.drawStats();
    
    window.scrollTo({top: 0, behavior: 'smooth'});
  },
  
  // Profile
  bindProfile: function() {
    const nameEl = $('#name');
    const ageEl = $('#age');
    const salaryEl = $('#salary');
    const hoursEl = $('#hours');
    const saveBtn = $('#saveProfile');
    const delBtn = $('#deleteProfile');
    
    const loadProfile = () => {
      const p = DataAPI.getProfile();
      if (!p) return;
      nameEl.value = p.name || '';
      ageEl.value = p.age || '';
      salaryEl.value = p.salary || '';
      hoursEl.value = p.hours || '';
    };
    
    const saveProfile = () => {
      const p = {
        name: nameEl.value.trim(),
        age: Number(ageEl.value),
        salary: Number(salaryEl.value),
        hours: Number(hoursEl.value)
      };
      
      if (!p.name || !p.age || !p.salary || !p.hours) {
        alert('T√∂lts ki minden mez≈ët!');
        return;
      }
      
      DataAPI.saveProfile(p);
      this.setView('calc');
    };
    
    const deleteProfile = () => {
      if (!confirm('Biztos t√∂rl√∂d a profilodat √©s a list√°kat?')) return;
      DataAPI.deleteProfile();
      nameEl.value = ageEl.value = salaryEl.value = hoursEl.value = '';
      this.setView('profile');
    };
    
    loadProfile();
    if (saveBtn) saveBtn.addEventListener('click', saveProfile);
    if (delBtn) delBtn.addEventListener('click', deleteProfile);
  },
  
  // Calculator
  bindCalculator: function() {
    const productName = $('#productName');
    const productPrice = $('#productPrice');
    const calcBtn = $('#calculateBtn');
    const calcResult = $('#calcResult');
    const saveBtn = $('#saveBtn');
    const buyBtn = $('#buyBtn');
    
    const calculate = () => {
      const p = DataAPI.getProfile();
      if (!p) {
        this.setView('profile');
        return;
      }
      
      const name = productName.value.trim();
      const price = Number(productPrice.value);
      
      if (!name || !price || price <= 0) {
        alert('Add meg a term√©k nev√©t √©s √°r√°t!');
        return;
      }
      
      const hourly = p.salary / (p.hours * 4);
      if (!hourly || hourly <= 0) {
        alert('√ârv√©nytelen profil adatok.');
        return;
      }
      
      const hours = price / hourly;
      
      $('#hourlyHint').textContent = `Jelenlegi √≥rab√©red ~ ${fmtFt(hourly)}/√≥ra`;
      $('#workHoursText').textContent = `Kb. ${hours.toFixed(1)} munka√≥r√°dba ker√ºlne (${fmtFt(price)}).`;
      
      calcResult.dataset.name = name;
      calcResult.dataset.price = String(price);
      calcResult.dataset.hours = String(hours);
      calcResult.classList.remove('hidden');
    };
    
    const commit = (type) => {
      const name = calcResult.dataset.name;
      const price = Number(calcResult.dataset.price);
      const hours = Number(calcResult.dataset.hours);
      
      if (!name || !price) {
        alert('El≈ëbb sz√°molj!');
        return;
      }
      
      DataAPI.addItem(type, {name, price, hours});
      
      if (type === 'spent' && hours > 10) {
        this.showCoach();
      } else {
        this.setView('results');
      }
    };
    
    if (calcBtn) calcBtn.addEventListener('click', calculate);
    if (saveBtn) saveBtn.addEventListener('click', () => commit('saved'));
    if (buyBtn) buyBtn.addEventListener('click', () => commit('spent'));
  },
  
  syncCalcHello: function() {
    const hello = $('#hello');
    const p = DataAPI.getProfile();
    
    if (!p) {
      if (hello) hello.textContent = 'Szia! T√∂ltsd ki a profilod a pontos sz√°m√≠t√°shoz.';
      return;
    }
    
    if (hello) hello.innerHTML = `Szia <b>${esc(p.name || '')}</b>! N√©zz√ºk meg, h√°ny √≥r√°dba ker√ºlne.`;
  },
  
  // Coach
  showCoach: function() {
    const MESSAGES = [
      "Ejnye, ez√©rt most sokat fogsz dolgozni. üò¨","A p√©nzt√°rc√°d halk s√≠r√°st hallatott. üí∏","A j√∂v≈ëbeli √©ned most cs√≥v√°lja a fej√©t.",
      "Ha boldogg√° tesz, ok√© ‚Äì de sok √≥r√°dba ker√ºl.","Ez m√°r a 'dr√°ga, de kell' kateg√≥ria? ü§®","A banksz√°ml√°d szabads√°gra ment.",
      "10 √≥r√°n t√∫l? Any√°d felh√≠vna. ü´®","Legk√∂zelebb √≠rd be: 'gondolkozzak m√©g'.","A racionalit√°s most eb√©del. üçΩÔ∏è",
      "Legal√°bb sz√©p lesz. Rem√©lj√ºk.","Ez egy hossz√∫ m≈±szak √°ra. ‚è≥","Instant dopamin, tart√≥s m√≠nusz. ‚ö°Ô∏è"
    ];
    
    const bubble = $('#coach');
    if (bubble) {
      bubble.textContent = 'Ap√°dhelyett Any√°d: ' + MESSAGES[Math.floor(Math.random() * MESSAGES.length)];
      bubble.classList.remove('hidden');
      setTimeout(() => {
        bubble.classList.add('hidden');
        this.setView('results');
      }, 2400);
    }
  },
  
  // Results
  bindResults: function() {
    const clearBtn = $('#clearAll');
    if (clearBtn) {
      clearBtn.addEventListener('click', () => {
        if (!confirm('Biztos √ºr√≠ted a list√°t?')) return;
        DataAPI.clearItems();
        this.renderResults();
        this.drawStats();
      });
    }
  },
  
  renderResults: function() {
    const saved = DataAPI.getSaved();
    const spent = DataAPI.getSpent();
    const savedList = $('#savedList');
    const spentList = $('#spentList');
    
    if (savedList) savedList.innerHTML = '';
    if (spentList) spentList.innerHTML = '';
    
    let totalSavedAmt = 0;
    let totalSpentAmt = 0;
    
    saved.forEach(it => {
      totalSavedAmt += Number(it.price);
      const li = document.createElement('li');
      li.className = 'item';
      li.innerHTML = `<span><span class="badge b-green">sp√≥rolt</span> <span class="name">${esc(it.name)}</span></span><span class="price">${fmtFt(it.price)}</span>`;
      if (savedList) savedList.appendChild(li);
    });
    
    spent.forEach(it => {
      totalSpentAmt += Number(it.price);
      const li = document.createElement('li');
      li.className = 'item';
      li.innerHTML = `<span><span class="badge b-red">vett</span> <span class="name">${esc(it.name)}</span></span><span class="price">${fmtFt(it.price)}</span>`;
      if (spentList) spentList.appendChild(li);
    });
    
    const totalSaved = $('#totalSaved');
    const totalSpent = $('#totalSpent');
    const net = $('#net');
    
    if (totalSaved) totalSaved.textContent = fmtFt(totalSavedAmt);
    if (totalSpent) totalSpent.textContent = fmtFt(totalSpentAmt);
    if (net) net.textContent = fmtFt(totalSavedAmt - totalSpentAmt);
  },
  
  // Stats
  drawStats: function() {
    const cvs = $('#statsCanvas');
    if (!cvs) return;
    
    const ctx = cvs.getContext('2d');
    const monthKey = (ts) => {
      const d = new Date(ts);
      return d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0');
    };
    
    const map = new Map();
    DataAPI.getSaved().forEach(it => {
      const k = monthKey(it.at || Date.now());
      const o = map.get(k) || {saved: 0, spent: 0};
      o.saved += Number(it.price) || 0;
      map.set(k, o);
    });
    DataAPI.getSpent().forEach(it => {
      const k = monthKey(it.at || Date.now());
      const o = map.get(k) || {saved: 0, spent: 0};
      o.spent += Number(it.price) || 0;
      map.set(k, o);
    });
    
    const arr = [...map.entries()].sort((a, b) => a[0] > b[0] ? 1 : -1).slice(-8);
    const labels = arr.map(x => x[0]);
    const savedData = arr.map(x => x[1].saved);
    const spentData = arr.map(x => x[1].spent);
    
    ctx.clearRect(0, 0, cvs.width, cvs.height);
    
    const P = {l: 48, r: 20, t: 14, b: 40};
    const W = cvs.width - P.l - P.r;
    const H = cvs.height - P.t - P.b;
    
    ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--line');
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(P.l, P.t);
    ctx.lineTo(P.l, P.t + H);
    ctx.lineTo(P.l + W, P.t + H);
    ctx.stroke();
    
    const maxVal = Math.max(1000, ...savedData, ...spentData);
    const y = (v) => P.t + H - (v / maxVal) * H;
    const barW = W / Math.max(1, labels.length) / 2.2;
    
    for (let i = 0; i < labels.length; i++) {
      const x0 = P.l + i * (W / labels.length) + 8;
      
      ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--green');
      ctx.fillRect(x0, y(savedData[i]), barW, (P.t + H) - y(savedData[i]));
      
      ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--red');
      ctx.fillRect(x0 + barW + 6, y(spentData[i]), barW, (P.t + H) - y(spentData[i]));
      
      ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted');
      ctx.font = '12px system-ui';
      ctx.textAlign = 'center';
      ctx.fillText(labels[i], x0 + barW / 2 + 3, P.t + H + 16);
    }
  }
};

// ================== INITIALIZE APP ==================
App.init();
</script>
</body>
</html>
